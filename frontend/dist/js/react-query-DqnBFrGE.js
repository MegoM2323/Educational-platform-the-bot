import{r as e,j as t}from"./react-core-JVqWokWt.js";import{M as r,N as s,O as n,Q as u,S as o,T as a,U as i}from"./vendor-DC2AZkDs.js";var c=e.createContext(void 0),l=t=>{const r=e.useContext(c);if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},f=({client:r,children:s})=>(e.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),t.jsx(c.Provider,{value:r,children:s})),p=e.createContext(!1);p.Provider;var h=e.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),m=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function d(t,o,a){var i,c,f,d,y;const g=e.useContext(p),C=e.useContext(h),R=l(),x=R.defaultQueryOptions(t);null==(c=null==(i=R.getDefaultOptions().queries)?void 0:i._experimental_beforeQuery)||c.call(i,x),x._optimisticResults=g?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,r=e=>"static"===e?e:Math.max(null!=e?e:t,t),s=e.staleTime;e.staleTime="function"==typeof s?(...e)=>r(s(...e)):r(s),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(x),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(x,C),(t=>{e.useEffect(()=>{t.clearReset()},[t])})(C);const O=!R.getQueryCache().get(x.queryHash),[b]=e.useState(()=>new o(R,x)),v=b.getOptimisticResult(x),E=!g&&!1!==t.subscribed;if(e.useSyncExternalStore(e.useCallback(e=>{const t=E?b.subscribe(s.batchCalls(e)):n;return b.updateResult(),t},[b,E]),()=>b.getCurrentResult(),()=>b.getCurrentResult()),e.useEffect(()=>{b.setOptions(x)},[x,b]),((e,t)=>(null==e?void 0:e.suspense)&&t.isPending)(x,v))throw m(x,b,C);if((({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:u})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(u&&void 0===e.data||r(s,[e.error,n])))({result:v,errorResetBoundary:C,throwOnError:x.throwOnError,query:R.getQueryCache().get(x.queryHash),suspense:x.suspense}))throw v.error;if(null==(d=null==(f=R.getDefaultOptions().queries)?void 0:f._experimental_afterQuery)||d.call(f,x,v),x.experimental_prefetchInRender&&!u&&((e,t)=>e.isLoading&&e.isFetching&&!t)(v,g)){const e=O?m(x,b,C):null==(y=R.getQueryCache().get(x.queryHash))?void 0:y.promise;null==e||e.catch(n).finally(()=>{b.updateResult()})}return x.notifyOnChangeProps?v:b.trackResult(v)}function y(e,t){return d(e,o)}function g(t,u){const o=l(),[i]=e.useState(()=>new a(o,t));e.useEffect(()=>{i.setOptions(t)},[i,t]);const c=e.useSyncExternalStore(e.useCallback(e=>i.subscribe(s.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),f=e.useCallback((e,t)=>{i.mutate(e,t).catch(n)},[i]);if(c.error&&r(i.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:f,mutateAsync:c.mutate}}function C(e,t){return d(e,i)}export{f as Q,y as a,g as b,C as c,l as u};
