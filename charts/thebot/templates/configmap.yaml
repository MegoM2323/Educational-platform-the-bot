{{- if .Values.configMap.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "thebot.configMapName" . }}
  namespace: {{ .Values.namespace.name | quote }}
  labels:
    {{- include "thebot.labels" . | nindent 4 }}
data:
  {{- range $key, $value := .Values.configMap.data }}
  {{ $key }}: {{ $value | quote }}
  {{- end }}

  # Django specific settings
  DJANGO_SETTINGS_MODULE: "config.settings.kubernetes"

  # Kubernetes specific settings
  K8S_ENVIRONMENT: "true"
  POD_NAMESPACE: {{ .Values.namespace.name | quote }}
  POD_NAME: "thebot"

  # Database settings
  DATABASE_HOST: {{ include "thebot.postgresql.name" . }}
  DATABASE_PORT: "5432"
  POSTGRES_DB: {{ .Values.postgresql.env.POSTGRES_DB | quote }}
  POSTGRES_USER: {{ .Values.postgresql.env.POSTGRES_USER | quote }}

  # Redis settings
  REDIS_HOST: {{ include "thebot.redis.name" . }}
  REDIS_PORT: "6379"

  # Celery settings
  CELERY_BROKER_URL: {{ printf "redis://%s:6379/0" (include "thebot.redis.name" .) | quote }}
  CELERY_RESULT_BACKEND: {{ printf "redis://%s:6379/1" (include "thebot.redis.name" .) | quote }}
{{- end }}
