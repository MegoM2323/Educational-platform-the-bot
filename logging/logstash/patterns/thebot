# Custom patterns for THE_BOT platform logs

# Django log patterns
DJANGO_TIMESTAMP \[%{TIMESTAMP_ISO8601}\]
DJANGO_LEVEL \[%{LOGLEVEL}\]
DJANGO_LOGGER %{DATA}
DJANGO_LOG %{DJANGO_TIMESTAMP} %{DJANGO_LEVEL} %{DJANGO_LOGGER} %{GREEDYDATA}

# HTTP request/response
HTTP_REQUEST %{WORD:http_method} %{DATA:http_path} %{WORD:http_protocol}/%{NUMBER:http_version}
HTTP_STATUS Status: %{NUMBER:http_status:int}
HTTP_TIME Time: %{NUMBER:response_time:float}ms
HTTP_LOG %{HTTP_REQUEST} %{HTTP_STATUS} %{HTTP_TIME}

# Celery task patterns
CELERY_TIMESTAMP %{INT}:M %{TIMESTAMP_ISO8601}
CELERY_LEVEL \[%{LOGLEVEL}\]
CELERY_TASK Task %{DATA:task_name}
CELERY_TASK_ID id=<%{DATA:task_id}>
CELERY_LOG %{CELERY_TIMESTAMP} %{CELERY_LEVEL} %{CELERY_TASK} %{CELERY_TASK_ID}

# PostgreSQL patterns
POSTGRES_TIMESTAMP %{TIMESTAMP_ISO8601}
POSTGRES_PID \[%{INT:postgres_pid}\]
POSTGRES_USER %{DATA:postgres_user}@%{DATA:postgres_db}
POSTGRES_LEVEL %{LOGLEVEL}
POSTGRES_LOG %{POSTGRES_TIMESTAMP} %{POSTGRES_PID} %{POSTGRES_USER} %{POSTGRES_LEVEL}: %{GREEDYDATA}

# Redis patterns
REDIS_PORT %{INT:redis_port}:M
REDIS_TIMESTAMP %{TIMESTAMP_ISO8601}
REDIS_LEVEL %{LOGLEVEL}
REDIS_LOG %{REDIS_PORT} %{REDIS_TIMESTAMP} %{REDIS_LEVEL} %{GREEDYDATA}

# API request patterns
API_REQUEST_ID request_id=%{UUID:request_id}
API_USER user_id=%{INT:user_id}
API_DURATION duration_ms=%{NUMBER:duration_ms:float}
API_ENDPOINT endpoint=%{DATA:endpoint}
API_STATUS status=%{INT:http_status:int}

# Authentication patterns
AUTH_LOGIN login\s+%{DATA:username}
AUTH_TOKEN token=%{DATA:token}
AUTH_FAILURE failed\s+for\s+%{DATA:username}
AUTH_SUCCESS successful\s+for\s+%{DATA:username}

# Error patterns
ERROR_EXCEPTION %{WORD:exception_type}:\s+%{GREEDYDATA:exception_message}
ERROR_TRACEBACK File\s+%{DATA:error_file},\s+line\s+%{INT:error_line}
ERROR_CONTEXT %{DATA:error_context}

# Security event patterns
SECURITY_EVENT event=%{DATA:security_event}
SECURITY_ACTION action=%{DATA:security_action}
SECURITY_RESULT result=%{WORD:security_result}

# Performance patterns
PERF_SLOW_QUERY slow\s+query:\s+%{GREEDYDATA:query}
PERF_SLOW_TIME execution_time=%{NUMBER:execution_time:float}ms

# Cache patterns
CACHE_HIT cache_hit\s+key=%{DATA:cache_key}
CACHE_MISS cache_miss\s+key=%{DATA:cache_key}
CACHE_SET cache_set\s+key=%{DATA:cache_key}\s+ttl=%{INT:cache_ttl}

# Database connection patterns
DB_CONNECTION connection\s+%{WORD:db_action}\s+%{INT:connection_count}\s+connections
DB_POOL pool_size=%{INT:pool_size}\s+available=%{INT:pool_available}

# Webhook/notification patterns
WEBHOOK webhook\s+%{WORD:webhook_event}\s+for\s+%{DATA:webhook_target}
NOTIFICATION notification\s+sent\s+to\s+%{INT:user_id}
