# THE_BOT Platform - Docker Compose Environment Configuration
#
# Usage:
#   docker-compose --env-file .env.docker up -d
#
# This file provides all environment variables needed to run the full stack in Docker.
# For development, you can copy and customize these values.
# For production, use proper secrets management.

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# PostgreSQL is required for all environments (development, staging, production)
# Do NOT use SQLite - it is not supported in production
#
# Use individual DB_* variables (not DATABASE_URL)
# DATABASE_URL is deprecated due to issues with special characters in passwords
DB_HOST=postgres
DB_PORT=5433
DB_NAME=thebot_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_SSLMODE=disable

# ============================================================================
# REDIS CONFIGURATION (Cache + Channels Layer)
# ============================================================================
REDIS_PASSWORD=redis
REDIS_PORT=6379

# ============================================================================
# DJANGO BACKEND CONFIGURATION
# ============================================================================
BACKEND_PORT=8000
ENVIRONMENT=development
DEBUG=True

# CRITICAL: Change this in production!
# Generate with: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=django-insecure-your-secret-key-here-change-in-production

# Allowed hosts for Django
ALLOWED_HOSTS=localhost,127.0.0.1,backend

# CORS configuration for frontend access
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000,http://localhost:8080

# ============================================================================
# FRONTEND CONFIGURATION
# ============================================================================
FRONTEND_PORT=3000
NODE_ENV=production
APP_NAME=THE_BOT

# API endpoints (relative URLs are proxied through nginx)
API_URL=http://localhost:8000/api
WS_URL=ws://localhost:8000/ws

# ============================================================================
# EXTERNAL SERVICES (Optional - comment out if not needed)
# ============================================================================

# Yookassa Payment Processing
YOOKASSA_SHOP_ID=
YOOKASSA_SECRET_KEY=

# OpenRouter AI API
OPENROUTER_API_KEY=

# Pachca Forum Integration
PACHCA_FORUM_API_TOKEN=

# Telegram Bot
TELEGRAM_BOT_TOKEN=

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=INFO

# ============================================================================
# NOTES
# ============================================================================
# 1. For development with relative API URLs:
#    - Browser connects to http://localhost:3000
#    - Nginx proxies /api/* and /ws/* to backend
#    - Backend is accessed through reverse proxy only
#
# 2. For production:
#    - Change SECRET_KEY to a secure random value
#    - Set DEBUG=False
#    - Use environment-specific ALLOWED_HOSTS
#    - Configure proper CORS_ALLOWED_ORIGINS
#    - Use proper database backup strategy
#    - Implement Redis persistence backup
#
# 3. WebSocket Configuration:
#    - Daphne runs on port 8000 with ASGI protocol
#    - Redis is used as Channels layer backend
#    - Connection timeout: 3600s (1 hour)
#    - Multiple instances require Redis for cross-process messaging
#
# 4. Service Dependencies:
#    - Frontend depends on Backend being healthy
#    - Backend depends on PostgreSQL and Redis being healthy
#    - All services restart automatically if stopped
#
# 5. Health Checks:
#    - PostgreSQL: pg_isready check
#    - Redis: redis-cli ping
#    - Backend: HTTP request to /api/system/health/
#    - Frontend: HTTP request to port 3000
