#!/usr/bin/env bash
# Скрипт для полной очистки всех мусорных данных из базы данных
# ВНИМАНИЕ: Эта команда удаляет данные без возможности восстановления!

cd "$(dirname "$0")/backend"

echo "=========================================="
echo "  ПОЛНАЯ ОЧИСТКА БАЗЫ ДАННЫХ"
echo "=========================================="
echo ""
echo "ВНИМАНИЕ: Эта команда удалит все мусорные данные:"
echo "  - Тестовые пользователи"
echo "  - Старые заявки"
echo "  - Старые сообщения и пустые чаты"
echo "  - Старые черновики"
echo "  - Старые уведомления"
echo "  - Неиспользуемые файлы"
echo ""
echo "Операция необратима!"
echo ""

read -p "Вы уверены, что хотите продолжить? (yes/no): " confirm

if [ "$confirm" != "yes" ] && [ "$confirm" != "y" ] && [ "$confirm" != "да" ] && [ "$confirm" != "д" ]; then
    echo "Очистка отменена."
    exit 0
fi

echo ""
echo "Запуск очистки..."
echo ""

../.venv/bin/python manage.py cleanup_database --all --force

echo ""
echo "=========================================="
echo "  Очистка завершена"
echo "=========================================="

