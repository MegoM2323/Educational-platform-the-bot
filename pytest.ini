[pytest]
# Django settings
DJANGO_SETTINGS_MODULE = config.settings
pythonpath = backend

# Test discovery patterns
python_files = tests.py test_*.py *_tests.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = backend/tests

# Command line options
addopts =
    --verbose
    --strict-markers
    --tb=short
    -p no:warnings
    --cov=accounts
    --cov=materials
    --cov=assignments
    --cov=chat
    --cov=reports
    --cov=notifications
    --cov=payments
    --cov=applications
    --cov=core
    --cov-report=term-missing
    --cov-report=html
    --no-cov-on-fail

# Test markers
markers =
    mandatory: Mandatory core functionality tests
    unit: Unit tests
    integration: Integration tests
    e2e: End-to-end tests
    websocket: WebSocket connection tests
    celery: Celery task tests
    slow: Slow running tests
    payment: Payment system tests
    subscription: Subscription tests
    webhook: Webhook tests
    django_db: Django database access marker

# Asyncio configuration
asyncio_default_fixture_loop_scope = function
asyncio_mode = auto

# Coverage configuration
[coverage:run]
source = .
omit =
    */migrations/*
    */tests/*
    */venv/*
    */.venv/*
    */env/*
    */node_modules/*
    */__pycache__/*
    */staticfiles/*
    */media/*
    manage.py
    */wsgi.py
    */asgi.py
    */settings.py
    */celery_config.py

[coverage:report]
precision = 2
show_missing = True
skip_covered = False
