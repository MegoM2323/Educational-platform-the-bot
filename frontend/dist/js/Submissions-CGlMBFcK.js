import{r as s,j as e}from"./react-core-JVqWokWt.js";import{S as i,a,e as t,C as r,B as d,Z as n,$ as l,_ as c}from"./main-fde3JC90.js";import{a as m,b as o,c as x}from"./useTeacher-DJCQuFgv.js";import{T as j}from"./TeacherSidebar-Bwv8PTW2.js";import{h}from"./fileDownload-DfJJnQoy.js";import{bF as u}from"./vendor-DC2AZkDs.js";import"./react-dom-DyRXjBRd.js";import"./radix-ui-Ch8xfAyl.js";import"./react-query-DqnBFrGE.js";import"./react-router-WAeXREDX.js";import"./charts-CKrVAx-o.js";import"./d3-lib-BmB4v4DK.js";import"./teacher-BhCI6v5d.js";function p(){const{data:p,isLoading:v}=m(),f=o(),b=x(),[g,N]=s.useState({}),[y,_]=s.useState({});return e.jsx(i,{children:e.jsxs("div",{className:"flex min-h-screen w-full",children:[e.jsx(j,{}),e.jsxs(a,{children:[e.jsxs("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4",children:[e.jsx(t,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),e.jsx("h1",{className:"text-lg font-semibold",children:"Задания на проверку"})]})]}),e.jsx("main",{className:"flex flex-1 flex-col gap-4 p-4",children:e.jsx(r,{className:"p-4",children:v?e.jsx("div",{children:"Загрузка..."}):e.jsxs("div",{className:"space-y-4",children:[null==p?void 0:p.map(s=>e.jsxs(r,{className:"p-4 space-y-3",children:[e.jsx("div",{className:"font-medium",children:s.student_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.material_title}),s.submission_text&&e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:s.submission_text}),s.submission_file&&e.jsx(d,{type:"button",variant:"outline",onClick:e=>h(e,s.submission_file,void 0,!0),children:"Открыть файл"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx(n,{children:"Фидбэк"}),e.jsx(l,{value:g[s.id]||"",onChange:e=>N({...g,[s.id]:e.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Оценка"}),e.jsx(c,{type:"number",min:1,max:100,value:y[s.id]||"",onChange:e=>_({...y,[s.id]:e.target.value})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{type:"button",onClick:()=>(async s=>{const e=g[s]||"",i=y[s]?Number(y[s]):void 0;await f.mutateAsync({submissionId:s,data:{feedback_text:e,grade:i}}),await b.mutateAsync({submissionId:s,status:"reviewed"})})(s.id),disabled:f.isPending||b.isPending,children:"Отправить фидбэк"}),e.jsx(d,{type:"button",variant:"outline",onClick:()=>b.mutate({submissionId:s.id,status:"needs_changes"}),disabled:b.isPending,children:"Запросить доработку"})]})]},s.id)),0===((null==p?void 0:p.length)||0)&&e.jsx("div",{children:"Нет заданий на проверку"})]})})})]})]})})}export{p as default};
