# Cloudflare CDN Configuration
# Copy this file to .env and fill in your values

# Cloudflare API Token (generate at https://dash.cloudflare.com/profile/api-tokens)
# Required scopes: Zone:Read, Cache Purge
CLOUDFLARE_API_TOKEN=your_api_token_here

# Cloudflare Zone ID (found in your domain's overview page)
CLOUDFLARE_ZONE_ID=your_zone_id_here

# Domain name
DOMAIN_NAME=thebot.example.com

# Origin server URL (your backend)
ORIGIN_URL=https://origin.thebot.example.com

# Frontend origin URL
FRONTEND_ORIGIN=https://frontend.thebot.example.com

# Cache purge token (for worker cache purging)
# Generate a strong random token: openssl rand -hex 32
CACHE_PURGE_TOKEN=your_cache_purge_token_here

# Enable advanced caching features (requires Enterprise plan)
ENABLE_ADVANCED_CACHE=false

# Cache busting parameters (comma-separated)
# Used to invalidate cached content
CACHE_BUST_PARAMS=v,version,bust,cachebust

# Performance settings
COMPRESSION_ENABLED=true
MINIFICATION_ENABLED=true
HTTP3_ENABLED=true
EARLY_HINTS_ENABLED=true

# Security settings
DDOS_PROTECTION_ENABLED=true
WAF_ENABLED=true
BOT_MANAGEMENT_ENABLED=true
RATE_LIMITING_ENABLED=true

# TTL Settings (in seconds)
CACHE_TTL_STATIC=2592000    # 30 days
CACHE_TTL_IMAGES=2592000    # 30 days
CACHE_TTL_HTML=0             # No cache
CACHE_TTL_API=0              # No cache
CACHE_TTL_MEDIA=604800       # 7 days

# Stale-while-revalidate settings (in seconds)
STALE_TTL_STATIC=86400       # 1 day
STALE_TTL_IMAGES=604800      # 7 days
STALE_TTL_MEDIA=86400        # 1 day

# Rate limiting thresholds
RATE_LIMIT_GLOBAL=1000       # requests per minute
RATE_LIMIT_API=100           # requests per minute
RATE_LIMIT_LOGIN=5           # requests per minute

# Ban duration (in seconds)
BAN_DURATION_GLOBAL=86400    # 24 hours
BAN_DURATION_API=3600        # 1 hour
BAN_DURATION_LOGIN=1800      # 30 minutes

# Logging and monitoring
LOGPUSH_ENABLED=true
LOGPUSH_FREQUENCY=low        # low, high
ANALYTICS_ENABLED=true
REAL_TIME_LOGS_ENABLED=true

# S3 bucket for logs (optional)
LOG_BUCKET_NAME=thebot-logs
LOG_BUCKET_REGION=us-east-1

# Terraform settings
TF_VAR_cloudflare_api_token=${CLOUDFLARE_API_TOKEN}
TF_VAR_cloudflare_zone_id=${CLOUDFLARE_ZONE_ID}
TF_VAR_domain_name=${DOMAIN_NAME}
TF_VAR_origin_url=${ORIGIN_URL}
TF_VAR_frontend_origin=${FRONTEND_ORIGIN}
