import{a as s,u as e,b as t}from"./react-query-DqnBFrGE.js";import{a as n}from"./migration-O34B3Isr.js";import{u as a}from"./main-fde3JC90.js";const i=async s=>{const e=new URLSearchParams;s&&Object.entries(s).forEach(([s,t])=>{null!=t&&""!==t&&e.append(s,String(t))});const t="/assignments/assignments/"+(e.toString()?`?${e.toString()}`:"");return(await n.get(t)).data},r=async s=>(await n.post("/assignments/assignments/",s)).data,o=async s=>{await n.delete(`/assignments/assignments/${s}/`)},u=async s=>(await n.get(`/assignments/assignments/${s}/submissions/`)).data,m=async(s,e)=>{const t=new FormData;t.append("content",e.content),e.file&&t.append("file",e.file);return(await n.post(`/assignments/assignments/${s}/submit/`,t,{headers:{"Content-Type":"multipart/form-data"}})).data},c=async(s,e)=>(await n.post(`/assignments/submissions/${s}/grade/`,e)).data,d=e=>s({queryKey:["assignments",e],queryFn:()=>i(e),staleTime:6e4}),l=()=>{const s=e(),{toast:n}=a();return t({mutationFn:s=>r(s),onSuccess:()=>{s.invalidateQueries({queryKey:["assignments"]}),n({title:"Успешно",description:"Задание создано"})},onError:s=>{n({title:"Ошибка",description:(null==s?void 0:s.message)||"Не удалось создать задание",variant:"destructive"})}})},g=()=>{const s=e(),{toast:n}=a();return t({mutationFn:s=>o(s),onSuccess:()=>{s.invalidateQueries({queryKey:["assignments"]}),n({title:"Успешно",description:"Задание удалено"})},onError:s=>{n({title:"Ошибка",description:(null==s?void 0:s.message)||"Не удалось удалить задание",variant:"destructive"})}})},y=s=>{const n=e(),{toast:i}=a();return t({mutationFn:e=>m(s,e),onSuccess:()=>{n.invalidateQueries({queryKey:["assignments"]}),n.invalidateQueries({queryKey:["assignment",s]}),n.invalidateQueries({queryKey:["submissions"]}),i({title:"Успешно",description:"Ответ отправлен"})},onError:s=>{i({title:"Ошибка",description:(null==s?void 0:s.message)||"Не удалось отправить ответ",variant:"destructive"})}})},p=s=>{const n=e(),{toast:i}=a();return t({mutationFn:e=>c(s,e),onSuccess:()=>{n.invalidateQueries({queryKey:["submission",s]}),n.invalidateQueries({queryKey:["submissions"]}),i({title:"Успешно",description:"Оценка выставлена"})},onError:s=>{i({title:"Ошибка",description:(null==s?void 0:s.message)||"Не удалось выставить оценку",variant:"destructive"})}})},v=e=>s({queryKey:["assignment-submissions",e],queryFn:()=>u(e),enabled:!!e,staleTime:6e4});export{y as a,l as b,g as c,v as d,p as e,d as u};
