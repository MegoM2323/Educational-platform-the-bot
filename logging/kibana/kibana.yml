# Kibana configuration for THE_BOT platform
# Web UI for exploring and visualizing logs

# Kibana server settings
server.name: thebot-kibana
server.host: "0.0.0.0"
server.port: 5601
server.compression.enabled: true
server.compression.referrerWhitelist: []

# Elasticsearch configuration
elasticsearch.hosts: ["http://elasticsearch:9200"]
elasticsearch.username: "elastic"
elasticsearch.password: ""
elasticsearch.requestTimeout: 30000
elasticsearch.shardTimeout: 30000

# Kibana index settings
kibana.index: ".kibana"
kibana.defaultAppId: "discover"
kibana.kibanaDefaultAppId: "discover"

# Index patterns - auto-create from logs
xpack.security.enabled: false
xpack.graph.enabled: true
xpack.reporting.enabled: true
xpack.watcher.enabled: true
xpack.ml.enabled: true
xpack.spaces.enabled: true

# Canvas
xpack.canvas.enabled: true

# Monitoring
xpack.monitoring.ui.container.elasticsearch.enabled: true

# Logging settings
logging:
  level: info
  appenders:
    default:
      type: console
      layout:
        type: pattern
        pattern: "[%date{ISO8601}][%level][%logger] %message"

# UI settings
xpack.infra.enabled: true
xpack.uptime.enabled: true

# APM integration
xpack.apm.enabled: true

# Device Metrics
xpack.discoverability.analytics.enabled: true

# Max size of request body (for bulk operations)
server.maxPayloadBytes: 104857600

# Session timeout (in milliseconds)
session.idleTimeout: 3600000
session.lifespan: 2592000000

# CSP (Content Security Policy)
csp.strict: false
csp.warnLegacyBrowsers: true

# OUI (Kibana UI component library)
uiSettings:
  defaults:
    # Index pattern settings
    "defaultIndex": "thebot-logs-*"
    "dateFormat": "MMM D, YYYY @ HH:mm:ss.SSS"
    "dateFormat:tz": "Browser"
    "defaultRoute": "/app/discover"

    # Discover settings
    "discover:sampleSize": 500
    "discover:aggs:terms:size": 20
    "discover:maxDocFieldsDisplayed": 50

    # Visualization settings
    "visualization:tileMap:maxPrecision": 7
    "visualization:colorMapping": {}

    # Table settings
    "format:defaultTypeMap": "{\"ip\": {\"id\": \"ip\", \"params\": {}}, \"date\": {\"id\": \"date\", \"params\": {}}, \"number\": {\"id\": \"number\", \"params\": {}}, \"_source\": {\"id\": \"_source\", \"params\": {}}, \"_all\": {\"id\": \"_all\", \"params\": {}}}"
    "format:number:defaultPattern": "0,0.[000]"
    "format:bytes:defaultPattern": "0,0b"
    "format:percent:defaultPattern": "0,0.00%"
    "format:duration:inputFormat": "seconds"
    "format:duration:outputFormat": "humanized"
    "format:duration:outputPrecision": 2

    # Metrics
    "metrics:max_buckets": 2000

    # Alerts
    "xpackReporting:maxConcurrentShardRequests": 6

    # Search timeout
    "query:queryString:options": "{\"analyze_wildcard\": true, \"fuzzy_prefix_length\": 0, \"fuzzy_max_expansions\": 50, \"phrase_slop\": 0}"

# Branding
xpack.branding.logo.darkMode.url: "/branding/logo-dark.svg"
xpack.branding.logo.defaultMode.url: "/branding/logo-light.svg"

# Telemetry
telemetry.enabled: true
telemetry.banner: false

# Deprecation warnings
xpack.deprecation.enabled: true
