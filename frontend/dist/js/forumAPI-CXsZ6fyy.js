import{f as r}from"./main-fde3JC90.js";const e={getForumChats:async()=>{const e=await r.request("/chat/forum/");if(e.error)throw new Error(e.error);if(e.data&&"object"==typeof e.data){if(Array.isArray(e.data.results))return e.data.results;if(Array.isArray(e.data))return e.data}return[]},getForumMessages:async(e,a=50,t=0,s)=>{const o=new URLSearchParams;"number"==typeof a&&o.append("limit",String(a)),"number"==typeof t&&o.append("offset",String(t));const n=o.toString(),i=`/chat/forum/${e}/messages/${n?"?"+n:""}`,d=await r.request(i,{signal:s});if(d.error)throw new Error(d.error);if(d.data&&"object"==typeof d.data){if(Array.isArray(d.data.results))return d.data.results;if(Array.isArray(d.data))return d.data}return[]},sendForumMessage:async(e,a)=>{var t,s;if(a.file){const s=new FormData;s.append("content",a.content),s.append("file",a.file),a.message_type&&s.append("message_type",a.message_type),a.reply_to&&s.append("reply_to",String(a.reply_to));const o=await r.request(`/chat/forum/${e}/send_message/`,{method:"POST",body:s});if(o.error)throw new Error(o.error);if(!(null==(t=o.data)?void 0:t.message))throw new Error("Invalid response from server");return o.data.message}const o=await r.request(`/chat/forum/${e}/send_message/`,{method:"POST",body:JSON.stringify(a)});if(o.error)throw new Error(o.error);if(!(null==(s=o.data)?void 0:s.message))throw new Error("Invalid response from server");return o.data.message},getAvailableContacts:async()=>{var e,a;const t=await r.request("/chat/available-contacts/");if(t.success,t.error,t.data,null==(a=null==(e=t.data)?void 0:e.results)||a.length,t.error)throw console.error("[forumAPI] getAvailableContacts error:",t.error),new Error(t.error);if(t.data&&"object"==typeof t.data){if(Array.isArray(t.data.results))return t.data.results.length,t.data.results;if(Array.isArray(t.data))return t.data.length,t.data}return console.warn("[forumAPI] Unexpected response structure, returning empty array. Response:",t),[]},initiateChat:async(e,a)=>{var t,s,o;const n={contact_user_id:e};void 0!==a&&(n.subject_id=a);const i=await r.request("/chat/initiate-chat/",{method:"POST",body:JSON.stringify(n)});if(i.success,i.error,i.data,null==(t=i.data)||t.created,null==(o=null==(s=i.data)?void 0:s.chat)||o.id,i.error)throw console.error("[forumAPI] initiateChat error:",i.error),new Error(i.error);if(!i.data)throw new Error("Invalid response from server: missing data");return i.data},editForumMessage:async(e,a,t)=>{var s;const o=await r.request(`/chat/forum/${e}/messages/${a}/edit/`,{method:"PATCH",body:JSON.stringify(t)});if(o.error)throw new Error(o.error);if(!(null==(s=o.data)?void 0:s.message))throw new Error("Invalid response from server: missing message");return o.data.message},deleteForumMessage:async(e,a)=>{const t=await r.request(`/chat/forum/${e}/messages/${a}/delete/`,{method:"DELETE"});if(t.error)throw new Error(t.error)},markChatAsRead:async e=>{const a=await r.request(`/chat/forum/${e}/mark_read/`,{method:"POST"});if(a.error)throw new Error(a.error)},pinMessage:async(e,a)=>{const t=await r.request(`/chat/forum/${e}/messages/${a}/pin/`,{method:"POST"});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("Invalid response from server: missing data");return t.data},lockChat:async e=>{const a=await r.request(`/chat/forum/${e}/lock/`,{method:"POST"});if(a.error)throw new Error(a.error);if(!a.data)throw new Error("Invalid response from server: missing data");return a.data},muteParticipant:async(e,a)=>{const t=await r.request(`/chat/forum/${e}/participants/${a}/mute/`,{method:"POST"});if(t.error)throw new Error(t.error);if(!t.data)throw new Error("Invalid response from server: missing data");return t.data}};export{e as f};
